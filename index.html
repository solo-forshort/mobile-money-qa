<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cybersecurity Q&A</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        background: #f4f4f9;
        padding: 20px;
    }
    h1 {
        text-align: center;
        color: #333;
    }
    .controls {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-bottom: 20px;
        flex-wrap: wrap;
    }
    .ask-question-btn {
        background: #27ae60;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        text-decoration: none;
        font-weight: bold;
        transition: background 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 5px;
    }
    .ask-question-btn:hover {
        background: #219a52;
    }
    input, select {
        padding: 8px;
        border-radius: 6px;
        border: 1px solid #ccc;
    }
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 15px;
    }
    .card {
        background: white;
        border-radius: 12px;
        padding: 12px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        min-height: 120px;
        max-height: 180px;
    }
    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .priority {
        font-weight: bold;
        padding: 4px 8px;
        border-radius: 6px;
        display: inline-block;
        color: white;
        margin-bottom: 5px;
    }
    .priority.High { background: #e74c3c; }
    .priority.Medium { background: #f39c12; }
    .priority.Low { background: #2ecc71; }
    .tag {
        background: #3498db;
        color: white;
        padding: 3px 8px;
        border-radius: 10px;
        font-size: 0.85em;
        display: inline-block;
        margin-bottom: 10px;
    }
    .question {
        font-size: 0.95em;
        margin-bottom: 8px;
        font-weight: bold;
        color: #333;
        line-height: 1.3;
    }
    .notes {
        font-size: 0.8em;
        color: #555;
        line-height: 1.3;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }
    .loading {
        text-align: center;
        color: #666;
        font-style: italic;
        margin-top: 50px;
    }
</style>
</head>
<body>

<h1>Mobile Money Security Q&A</h1>

<div class="controls">
    <input type="text" id="search" placeholder="Search questions...">
    <select id="priorityFilter">
        <option value="">All Priorities</option>
        <option value="High">High</option>
        <option value="Medium">Medium</option>
        <option value="Low">Low</option>
    </select>
    <a href="https://docs.google.com/forms/d/e/1FAIpQLSc4S6LV8NWwomzoGudHhDoAdwbQUblw3jOjVmvk4l6275Voeg/viewform?usp=sharing&ouid=117936331264839609159" target="_blank" class="ask-question-btn">
        Ask a Question
    </a>
</div>

<div class="grid" id="cardContainer">
    <div class="loading">Loading questions from Google Sheets...</div>
</div>

<script>
    const sheetURL = "https://opensheet.elk.sh/12bqzmih2nvVQnSYAMggXG3FBrbZyXhC5IaAEhqydkb0/responseform";
    let allData = [];

    // Sample data for preview in case the API doesn't load
    const sampleData = [
        {
            Question: "How can I know a transaction is fake?",
            Priority: "High",
            Tag: "Mobile Money Fraud",
            Notes: "Key Point: Vendors should never share their mobile money PIN"
        },
        {
            Question: "Can a person withdraw money from your wallet without any action from the MoMo user?",
            Priority: "Medium",
            Tag: "PIN Safety & Authentication",
            Notes: "Extra Detail: Even trusted staff or relatives should not have access"
        },
        {
            Question: "What should I do if I lose my SIM card?",
            Priority: "High",
            Tag: "SIM Security",
            Notes: "Immediately contact your network provider to block the SIM"
        },
        {
            Question: "How can I secure my mobile money PIN?",
            Priority: "High",
            Tag: "PIN Safety",
            Notes: "Never share your PIN with anyone, including family members"
        },
        {
            Question: "What are common mobile money scams?",
            Priority: "Medium",
            Tag: "Fraud & Scam Alerts",
            Notes: "Be aware of fake promotion messages and unauthorized transactions"
        },
        {
            Question: "How do I verify a mobile money agent?",
            Priority: "Medium",
            Tag: "Agent Verification",
            Notes: "Check for official signage and ask for proper identification"
        }
    ];

    // Try to fetch from the actual API, fallback to sample data
    fetch(sheetURL)
        .then(res => res.json())
        .then(data => {
            // Map your Google Sheets columns to the expected format
            allData = data.filter(row => {
                const question = row["Question 1\nWhat common mobile money security question or concern do you have? \n      Example: \"What do I do if I lose my SIM card?\" or\n                        \"How can I know a transaction is fake?\""];
                return question && question.trim() !== "";
            }).map(row => ({
                Question: row["Question 1\nWhat common mobile money security question or concern do you have? \n      Example: \"What do I do if I lose my SIM card?\" or\n                        \"How can I know a transaction is fake?\""] || "",
                Priority: row["Priority (H/M/L) "] === "H" ? "High" : row["Priority (H/M/L) "] === "M" ? "Medium" : row["Priority (H/M/L) "] === "L" ? "Low" : row["Priority (H/M/L) "] || "Medium",
                Tag: row["Tag (e.g., SIM swap, phishing, PIN safety)."] || row["Question 2\nWhich category does your question fit best?  "] || "Mobile Money",
                Notes: row["Notes â†’ any extra remarks"] || row["Question 3\nPlease describe a real situation or example of your concern (if you have one).  "] || "No additional notes"
            }));
            
            if (allData.length === 0) {
                allData = sampleData;
            }
            renderCards(allData);
        })
        .catch(error => {
            console.log("Using sample data due to API error:", error);
            allData = sampleData;
            renderCards(allData);
        });

    function renderCards(data) {
        const container = document.getElementById("cardContainer");
        container.innerHTML = "";

        data.forEach(row => {
            const card = document.createElement("div");
            card.className = "card";

            const priority = document.createElement("div");
            priority.className = `priority ${row.Priority}`;
            priority.textContent = row.Priority || "Unknown";

            const tag = document.createElement("div");
            tag.className = "tag";
            tag.textContent = row.Tag || "General";

            const question = document.createElement("div");
            question.className = "question";
            question.textContent = row.Question;

            const notes = document.createElement("div");
            notes.className = "notes";
            notes.textContent = row.Notes || "No additional notes";

            card.appendChild(priority);
            card.appendChild(tag);
            card.appendChild(question);
            card.appendChild(notes);

            container.appendChild(card);
        });
    }

    document.getElementById("search").addEventListener("input", function () {
        const term = this.value.toLowerCase();
        const filtered = allData.filter(row =>
            row.Question.toLowerCase().includes(term)
        );
        renderCards(filtered);
    });

    document.getElementById("priorityFilter").addEventListener("change", function () {
        const selected = this.value;
        const filtered = selected
            ? allData.filter(row => row.Priority === selected)
            : allData;
        renderCards(filtered);
    });
</script>

</body>
</html>
